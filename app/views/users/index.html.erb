
<%= stylesheet_link_tag  'sub_user', media: 'all', 'data-turbolinks-track' => true %>
<style>
  .gust-email input
  {
    width: 355px;
    padding: 0 20px;
    margin-bottom: 25px;
  }
</style>
<!--main_body_section-start-->
<div class="main_edit_section">
  <div class="container">
    <div class="col-md-12">
      <h1 class="main_edit_hadding">Super Admin</h1>
    </div>
    <div class="col-md-12">
      <div class="edit_content_eria">
        <div class="gust-email">
          <h3>Manage Users  </h3>
          <%= form_tag({:controller => 'users', :action => 'index'}, :method => 'get') do %>
              <%= text_field_tag(:email, params[:email], :placeholder => 'Email' ) %>
              <%= text_field_tag(:name, params[:name], :placeholder => 'Name') %>
              <%= text_field_tag(:firm, params[:firm], :placeholder => 'Company') %>
              <%= submit_tag("Search", :name => nil , class:'pull-right btn btn-primary' ) %>
          <% end %>
          <div class="clear-fix"></div>
        </div>

        <div class="tx_edit_full_width tx_edit_margin">
          <div class="col-lg-12 user-detail-conten">
            <% if !@users.blank? %>
            <table>
              <tr>
                <td width="20%"><h3 class="tx__light_bold">Active Users</h3></td>
                <td width="20%">&nbsp;</td>
                <td width="19%">&nbsp;</td>
                <td width="31%">&nbsp;</td>
              </tr>
            </table>
            <table width="100%" id="users_list" class="table table-striped table-hover" cellspacing="0">
              <thead>
                <tr  class="active-user-hd">
                  <td height="30"><h4> Name</h4></td>
                  <td><h4>Email</h4></td>
                  <td><h4>Company</h4></td>
                  <td></td>
                  <td></td>
                  <td></td>
                </tr>
              </thead>
                <tbody>
                <% @users.each do |user| %>
                  <tr class="active-user-p">
                    <td><p><%= "#{user.first_name} #{user.last_name}" %></p></td>
                    <td><p><%= "#{user.email}" %></p></td>
                    <td><p><%= "Company" %></p></td>
                    <td><a href="#" id="<%= user.id %>" class="btn btn-primary btn-sm password_change" data-toggle="modal" data-target="#exampleModa2" data-whatever="@mdo0"> Password</a></td>
                    <td>
                      <% if user.parent_id == nil %>
                          <%= link_to 'Sub-users', {:controller => 'users', :action => 'sub_users', :id => user.id}, :class => 'btn btn-primary btn-sm' %>
                      <% end %>
                    </td>
                    <td>
                      <%= link_to 'Edit', {:controller => 'profile', :action => 'update', :id => user.id}, :class => 'btn btn-primary btn-sm' %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
            <% else %>
              <%= 'No record found' %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="exampleModa2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2" aria-hidden="true">
  <div class="modal-dialog modal-dialog-user" role="document">
    <div class="modal-content modal-content-user">
      <div class="modal-header modal-header-new-user">

        <h4 class="modal-title modal-title-user-hd" id="exampleModalLabel2">Change Password</h4>

      </div>
      <div class="modal-body modal-body-new-user">
        <div class="gust-email full-width">
          <%= form_for(@user, :url => 'profile/password/' , html: { method: :post , :class => 'tx_form_content', :id => 'tx_form_content'} ) do |f| %>

              <div class="form-group input-group">
                <%= f.password_field :password, autofocus: true , class: 'form-control' , placeholder: "Password" %>
              </div>

              <div class="form-group input-group">
                <%= f.password_field :password_confirmation, autocomplete: "off", class: 'form-control' , placeholder: "Confirm Password" %>
              </div>

        </div>

      </div>
      <div class="modal-footer modal-footer-user">
        <button class='btn btn-def btn-block tx_orange_btn' type='submit'>Change</button>
        <button type="button" class="btn btn-secondary close-user-btn" data-dismiss="modal">Cancel</button>
      </div>
          <% end %>
    </div>
  </div>
</div>
<script>
  $(document).ready(function() {
    $('#users_list').dataTable({
    });
  });

  $('.password_change').click(function() {
    $('.tx_form_content').attr('action', 'profile/password/?id='+this.id);
  });

</script>
